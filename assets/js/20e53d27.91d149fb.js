"use strict";(self.webpackChunkxxnetwork_docs=self.webpackChunkxxnetwork_docs||[]).push([[5055],{3905:(e,t,i)=>{i.d(t,{Zo:()=>d,kt:()=>y});var r=i(7294);function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)i=s[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)i=s[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}var l=r.createContext({}),c=function(e){var t=r.useContext(l),i=t;return e&&(i="function"==typeof e?e(t):a(a({},t),e)),i},d=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var i=e.components,n=e.mdxType,s=e.originalType,l=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),p=c(i),h=n,y=p["".concat(l,".").concat(h)]||p[h]||u[h]||s;return i?r.createElement(y,a(a({ref:t},d),{},{components:i})):r.createElement(y,a({ref:t},d))}));function y(e,t){var i=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=i.length,a=new Array(s);a[0]=h;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[p]="string"==typeof e?e:n,a[1]=o;for(var c=2;c<s;c++)a[c]=i[c];return r.createElement.apply(null,a)}return r.createElement.apply(null,i)}h.displayName="MDXCreateElement"},9290:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var r=i(7462),n=(i(7294),i(3905));const s={},a="cMix Client Keystore",o={unversionedId:"cmix/xxdk/guides/cmix-client-keystore",id:"cmix/xxdk/guides/cmix-client-keystore",title:"cMix Client Keystore",description:"The cMix Client Keystore is a directory-backed encrypted key-value storage which contains cryptographic keys and state data. It is implemented by wrapping the EKV library.",source:"@site/docs/cmix/xxdk/guides/cmix-client-keystore.md",sourceDirName:"cmix/xxdk/guides",slug:"/cmix/xxdk/guides/cmix-client-keystore",permalink:"/all-docs/docs/cmix/xxdk/guides/cmix-client-keystore",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Reference Guides",permalink:"/all-docs/docs/category/reference-guides"},next:{title:"NDF Retrieval",permalink:"/all-docs/docs/cmix/xxdk/guides/ndf-retrieval"}},l={},c=[{value:"Client Identity",id:"client-identity",level:2},{value:"Other Critical Key Structures Stored in the Keystore",id:"other-critical-key-structures-stored-in-the-keystore",level:2}],d={toc:c},p="wrapper";function u(e){let{components:t,...i}=e;return(0,n.kt)(p,(0,r.Z)({},d,i,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"cmix-client-keystore"},"cMix Client Keystore"),(0,n.kt)("p",null,"The cMix Client Keystore is a directory-backed encrypted key-value storage which contains cryptographic keys and state data. It is implemented by wrapping the ",(0,n.kt)("a",{parentName:"p",href:"https://git.xx.network/elixxir/ekv"},"EKV library"),"."),(0,n.kt)("p",null,"The keystore is initially populated by a small number of critical keys that define a client\u2019s identity. It holds all the information necessary to send messages (transmission) as well as to receive messages (reception or message pickup) on the cMix network. The keystore is extended as needed to store key and state information for various subsystems (e.g., E2E messaging)."),(0,n.kt)("h1",{id:"handling-the-client-keystore"},"Handling the Client Keystore"),(0,n.kt)("p",null,"The Client Keystore requires a directory path where it will be initialized. A client must provide a path to a directory on a filesystem as well as a password that will be used to encrypt the contents of the directory. Once initialized, several encrypted files are generated at that path and used to store a variety of things that must persist across runs of the client. "),(0,n.kt)("p",null,"The password used to encrypt the contents of the keystore must be provided by the user or stored securely using secure storage, for example by using the ",(0,n.kt)("a",{parentName:"p",href:"https://developer.android.com/reference/android/security/KeyChain"},"Android")," or ",(0,n.kt)("a",{parentName:"p",href:"https://developer.apple.com/documentation/security/keychain_services"},"iOS Keychain")," APIs. "),(0,n.kt)("h1",{id:"key-generation-on-initialization"},"Key Generation on Initialization"),(0,n.kt)("p",null,"The cMix Client Keystore must be initialized on first run. Initializing the keystore creates a series of keys for outbound (transmission) communication with the xx network. These transmission keys are then used to register and negotiate a key with each node on the network. "),(0,n.kt)("p",null,"The process generally takes 20~30 seconds on first run, but can take upwards of five minutes in rare cases. As a result, it is highly recommended in almost all cases to persist the initialized keystore across executions of the cMix client."),(0,n.kt)("h2",{id:"client-identity"},"Client Identity"),(0,n.kt)("p",null,"At first, only the base data for sending messages (transmission) and receiving messages (reception) are stored in the keystore. These two sets of data include:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Transmission Identity"),(0,n.kt)("ol",{parentName:"li"},(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"RSA Transmission Keys:")," The transmission keys are a pair of RSA private/public keys used to register with the xx network. The public key is signed by the client registrar, a temporary system run by the foundation to allow the registration of new clients to be disabled in the event of certain network attacks. In the future, this system will be replaced with an on-chain registrar which registers new users for a fee in xx coins."),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"RSA Transmission ID:")," This\xa0is a unique identifier\xa0used for sending messages over the network. It is generated using a salt\xa0and the RSA transmission public key."))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Legacy Reception Identity"),(0,n.kt)("ol",{parentName:"li"},(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"RSA Reception Keys:")," The ",(0,n.kt)("a",{parentName:"li",href:"../technical-glossary#user-discovery-ud"},"User Discovery")," system run by the xx foundation requires a signed reception identity for registration. While registration identities are generally intended to be fungible, for the xx messenger and xx foundation user discovery server, they are not and must be signed. This allows it to piggy back off of the protection mechanisms described in the ",(0,n.kt)("em",{parentName:"li"},"RSA Transmission Keys")," section above.  "),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"RSA Reception ID:")," This is a unique identifier used by a cMix client to receive messages. It will typically poll this ID when looking for messages sent from other users. This ID is generated from a combination of a salt and the RSA reception public key. ")))),(0,n.kt)("h2",{id:"other-critical-key-structures-stored-in-the-keystore"},"Other Critical Key Structures Stored in the Keystore"),(0,n.kt)("p",null,"While a small set of keys are stored on initial execution, that group grows as various modules are exercised. Here are some of the more important keys which are stored in the client Keystore. This is not an exhaustive list."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"E2E keys:")," When a cMix client requests or receives requests for an authenticated connection with another client, it uses its end-to-end (E2E) identity. This is a pair of Diffie-Helman (DH) keys."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"cMix state data"),": Due to the decentralized nature of the xx network and the cMix protocol, there is no central repository for the state of message picking for an individual reception ID.  Instead, it is the client\u2019s responsibility to build a picture of the network and track its own message pickup information. This data is stored in the keystore as the client runs. The bulk of the data and its handling can be found in the ",(0,n.kt)("a",{parentName:"li",href:"https://git.xx.network/elixxir/client/-/tree/release/cmix/identity"},"/cmix/identity")," package."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Network signatures:")," As described in the ",(0,n.kt)("em",{parentName:"li"},"Client Identity")," section above, the Transmission Identity as well as the Legacy Reception Identity are signed by the Network Registrar. These signatures are stored in ",(0,n.kt)("a",{parentName:"li",href:"https://git.xx.network/elixxir/client/-/tree/release/storage/user"},"/storage/user")," as the ",(0,n.kt)("inlineCode",{parentName:"li"},"TransmissionRegistrationValidationsSignature"),", and the ",(0,n.kt)("inlineCode",{parentName:"li"},"ReceptionRegistrationValidationsSignature"),(0,n.kt)("em",{parentName:"li"},".")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Node keypairs:")," Clients negotiate symmetric keys with every node in the network in order to receive the mixes the nodes are a part of. These keys are stored in the keystore in ",(0,n.kt)("a",{parentName:"li",href:"https://git.xx.network/elixxir/client/-/tree/release/cmix/nodes"},"/cmix/nodes"),".")))}u.isMDXComponent=!0}}]);